{"version":3,"sources":["map.listing.js"],"names":["map","MapConfig","listing","markerList","Google","GoogleMap","mapBox","InfoBox","openInfoBox","$listingCard","$","Marker","latlng","marker","icon","this","markerObj","markerIcon","setMap","init","generateListing","addCustomMarker","cardHoverIndicateMarker","markerGrouping","customZoomControl","PageConfig","getMap","each","$this","lat","parseFloat","data","split","lng","list","image","find","attr","title","text","url","description","rating","starIcon","latLng","html","addHTML","push","box","document","createElement","className","boxOptions","content","disableAutoPan","alignBottom","maxWidth","pixelOffset","google","maps","Size","zIndex","boxStyle","width","closeBoxMargin","closeBoxURL","infoBoxClearance","isHidden","pane","enableEventPropagation","i","length","LatLng","event","addDomListener","listener","setOptions","innerHTML","close","open","addListener","click","e","preventDefault","removeClass","on","markerId","undefined","active","div","addClass","MarkerClusterer","imagePath","styles","height","minClusterSize","window","center","getCenter","trigger","setCenter","ready","prototype","OverlayView","draw","_this","dataset","getPanes","overlayImage","appendChild","point","getProjection","fromLatLngToDivPixel","style","left","top","remove","parentNode","removeChild","getPosition"],"mappings":"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","file":"map.listing.js","sourcesContent":["\"use strict\";\r\n\r\n//=> Global variables\r\nvar MapConfig = MapConfig || {};\r\nvar map;\r\nvar listing = [];\r\nvar markerList = [];\r\nvar Google = new GoogleMap();\r\nvar mapBox = new InfoBox();\r\nvar openInfoBox = 'open-infobox';\r\nvar $listingCard = $('#listing_data .listing-card');\r\n\r\n//=> Class Definition\r\n$(function () {\r\n    MapConfig = {\r\n        //=> Initialize function to call all functions of the class\r\n        init: function () {\r\n            MapConfig.generateListing();\r\n            MapConfig.addCustomMarker();\r\n            MapConfig.cardHoverIndicateMarker();\r\n            MapConfig.markerGrouping();\r\n            Google.customZoomControl(map);\r\n        },\r\n\r\n        /*!\r\n         * Getting listing data form HTML page.\r\n         * Generate list to bind in data in map\r\n         *---------------------------------------------------*/\r\n        generateListing: function () {\r\n            // Get map data from HTML page script\r\n            map = PageConfig.getMap();\r\n\r\n            // Each loop for listing card & push in array\r\n            $listingCard.each(function () {\r\n                var $this = $(this);\r\n                var lat = parseFloat($this.data('lat-lng').split(',')[0]);\r\n                var lng = parseFloat($this.data('lat-lng').split(',')[1]);\r\n\r\n                var list = {\r\n                    image: $this.find('.listing-image img').attr('src'),\r\n                    title: $this.find('.listing-title').text(),\r\n                    url: $this.find('.listing-title').attr('href'),\r\n                    description: $this.find('.listing-desc p').text(),\r\n                    rating: $this.find('.listing-rating .listing-rating-number').text(),\r\n                    starIcon: '<i class=\"ion-md-star\"></i>',\r\n                    latLng: {lat: lat, lng: lng},\r\n                    markerIcon: $this.data('marker-icon')\r\n                };\r\n\r\n                list.html = addHTML(list);\r\n                listing.push(list);\r\n            });\r\n\r\n            // Add HTML to list for bind in infobox\r\n            function addHTML(list) {\r\n                return '<div class=\"listing-map-container\">' +\r\n                    '<a href=\"javascript:void(0);\" class=\"infoBox-close\"><i class=\"ion-ios-close-circle\"></i></a>' +\r\n                    '<a href=\"'+ list.url +'\" class=\"listing-map-image\">' +\r\n                    '<img src=\"'+ list.image +'\" alt=\"'+ list.title +'\">' +\r\n                    '</a>' +\r\n                    '<div class=\"listing-content\">' +\r\n                    '<div class=\"listing-content-head\">' +\r\n                    '<div class=\"listing-rating\">' +\r\n                    '<span class=\"listing-rating-number\">' + list.rating + '</span>' + list.starIcon +\r\n                    '</div>' +\r\n                    '<div class=\"listing-desc\">' +\r\n                    '<a href=\"'+ list.url +'\" class=\"listing-title text-truncate\">' + list.title + '</a>' +\r\n                    '<p>' + list.description + '</p>' +\r\n                    '</div>' +\r\n                    '</div>' +\r\n                    '</div></div>';\r\n            }\r\n        },\r\n\r\n        /*!\r\n         * Add custom marker in map.\r\n         *---------------------------------------------------*/\r\n        addCustomMarker: function () {\r\n            var show = 'show';\r\n            var box = document.createElement(\"div\");\r\n            box.className = 'map-box';\r\n\r\n            var currentInfobox;\r\n\r\n            var boxOptions = {\r\n                content: box,\r\n                disableAutoPan: false,\r\n                alignBottom : true,\r\n                maxWidth: 0,\r\n                pixelOffset: new google.maps.Size(-122, -25),\r\n                zIndex: null,\r\n                boxStyle: {\r\n                    width: \"280px\"\r\n                },\r\n                closeBoxMargin: \"0\",\r\n                closeBoxURL: \"\",\r\n                infoBoxClearance: new google.maps.Size(25, 25),\r\n                isHidden: false,\r\n                pane: \"floatPane\",\r\n                enableEventPropagation: false,\r\n            };\r\n\r\n            for (var i = 0; i < listing.length; i++) {\r\n                var position = new google.maps.LatLng(listing[i].latLng),\r\n                    marker = new Marker(position, map, {marker: i}, listing[i].markerIcon);\r\n\r\n                markerList.push(marker);\r\n\r\n                google.maps.event.addDomListener(marker, 'click', (function(marker, i) {\r\n                    return function (listener) {\r\n                        mapBox.setOptions(boxOptions);\r\n                        box.innerHTML = listing[i].html;\r\n                        box.className = show;\r\n                        mapBox.close();\r\n                        mapBox.open(map, marker);\r\n                        currentInfobox = i + 1;\r\n\r\n                        google.maps.event.addListener(mapBox, 'domready', function () {\r\n                            $('.infoBox-close').click(function (e) {\r\n                                e.preventDefault();\r\n                                mapBox.close();\r\n                                $('.map-marker').removeClass(openInfoBox);\r\n                            });\r\n\r\n                        });\r\n\r\n                    }\r\n                })(marker, i));\r\n            }\r\n        },\r\n\r\n        /*!\r\n         * On hover of a list card linked the marker.\r\n         * Show animation on marker\r\n         *---------------------------------------------------*/\r\n        cardHoverIndicateMarker: function () {\r\n            var hover = 'hover-infobox';\r\n            $listingCard.on('mouseover', function () {\r\n                var $this = $(this);\r\n                var markerId = $this.data('marker-id');\r\n\r\n                if(markerId !== undefined) {\r\n                    var active = markerList[markerId - 1].div;\r\n                    $(active).addClass(hover);\r\n\r\n                    $this.on('mouseout', function () {\r\n                        $(active).removeClass(hover);\r\n                    })\r\n                }\r\n            });\r\n        },\r\n\r\n        /*!\r\n         * Cluster the marker group and showing calculation\r\n         * of marker\r\n         *---------------------------------------------------*/\r\n        markerGrouping: function () {\r\n            var markerStyles = [\r\n                {\r\n                    url: '',\r\n                    height: 36,\r\n                    width: 36\r\n                }\r\n            ];\r\n\r\n            var options = {\r\n                imagePath: 'images/',\r\n                styles : markerStyles,\r\n                minClusterSize : 2\r\n            };\r\n\r\n            var markerGroup = new MarkerClusterer(map, markerList, options);\r\n            google.maps.event.addDomListener(window, \"resize\", function() {\r\n                var center = map.getCenter();\r\n                google.maps.event.trigger(map, \"resize\");\r\n                map.setCenter(center);\r\n            });\r\n        }\r\n    };\r\n\r\n    //=> Call class at document ready\r\n    $(document).ready(MapConfig.init);\r\n});\r\n\r\n\r\n//=> Constructor for marker\r\nfunction Marker(latlng, map, marker, icon) {\r\n    this.latlng = latlng;\r\n    this.markerObj = marker;\r\n    this.markerIcon = icon;\r\n    this.setMap(map);\r\n}\r\n\r\nMarker.prototype = new google.maps.OverlayView();\r\n\r\n//=> Google map prototype for draw\r\nMarker.prototype.draw = function() {\r\n    var _this = this;\r\n    var div = this.div;\r\n    if (!div) {\r\n        div = this.div = document.createElement('div');\r\n        div.className = 'map-marker';\r\n\r\n        // Set HTML in map marker\r\n        div.innerHTML = '<div class=\"marker-container\">' +\r\n            '<div class=\"marker-icon\"><i class=\"'+ this.markerIcon +'\"></i></div>' +\r\n            '<svg xmlns=\"http://www.w3.org/2000/svg\" x=\"0px\" y=\"0px\" width=\"36px\" height=\"48px\" viewBox=\"0 0 36 48\" enable-background=\"new 0 0 36 48\" xml:space=\"preserve\">' +\r\n            '<path fill=\"#eb354e\" d=\"M18,0C8.076,0,0,8.132,0,18.13C0,32.336,17.306,47.384,18,48c0.694-0.618,18-15.664,18-29.87C36,8.132,27.924,0,18,0z' +\r\n            ' M18,28c-5.514,0-10-4.486-10-10S12.486,8,18,8c5.514,0,10,4.486,10,10S23.514,28,18,28z\"/>' +\r\n            '<circle class=\"marker-circle\" cx=\"18\" cy=\"18\" r=\"15\"/>' +\r\n            '</svg>' +\r\n            '</div>' +\r\n            '<div class=\"marker-shadow\"></div>';\r\n\r\n        // Clicked marker highlight\r\n        google.maps.event.addDomListener(div, \"click\", function(event) {\r\n            $('.map-marker').removeClass(openInfoBox);\r\n            google.maps.event.trigger(_this, \"click\");\r\n            $(this).addClass(openInfoBox);\r\n        });\r\n\r\n        if (typeof(_this.markerObj.marker) !== 'undefined') {\r\n            div.dataset.marker = _this.markerObj.marker;\r\n        }\r\n\r\n        var panes = this.getPanes();\r\n        panes.overlayImage.appendChild(div);\r\n    }\r\n\r\n    var point = this.getProjection().fromLatLngToDivPixel(this.latlng);\r\n    if (point) {\r\n        div.style.left = (point.x) + 'px';\r\n        div.style.top = (point.y) + 'px';\r\n    }\r\n}\r\n\r\nMarker.prototype.remove = function() {\r\n    if (this.div) {\r\n        this.div.parentNode.removeChild(this.div);\r\n        this.div = null; $(this).removeClass(openInfoBox);\r\n    }\r\n};\r\n\r\nMarker.prototype.getPosition = function() { return this.latlng; };\r\n\r\n\r\n\r\n\r\n"]}